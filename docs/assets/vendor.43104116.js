var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e={};(function(){var e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var n=0;n<e.length;++n){var i=e[n];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);var i="function"==typeof Object.assign?Object.assign:function(t,e){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};!function(t,i){if(i)t:{var r=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];if(!(a in r))break t;r=r[a]}(i=i(o=r[t=t[t.length-1]]))!=o&&null!=i&&e(r,t,{configurable:!0,writable:!0,value:i})}}("Object.assign",(function(t){return t||i}));var r=this||self,o={facingMode:"user",width:640,height:480};function a(t,e){this.video=t,this.h=0,this.g=Object.assign(Object.assign({},o),e)}function s(t){window.requestAnimationFrame((function(){!function(t){var e=null;t.video.paused||t.video.currentTime===t.h||(t.h=t.video.currentTime,e=t.g.onFrame()),e?e.then((function(){s(t)})):s(t)}(t)}))}a.prototype.start=function(){var t=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists.");var e=this.g;return navigator.mediaDevices.getUserMedia({video:{facingMode:e.facingMode,width:e.width,height:e.height}}).then((function(e){!function(t,e){t.video.srcObject=e,t.video.onloadedmetadata=function(){t.video.play(),s(t)}}(t,e)})).catch((function(t){throw console.error("Failed to acquire camera feed: "+t),alert("Failed to acquire camera feed: "+t),t}))};var l,c=["Camera"],u=r;c[0]in u||void 0===u.execScript||u.execScript("var "+c[0]);for(;c.length&&(l=c.shift());)c.length||void 0===a?u=u[l]&&u[l]!==Object.prototype[l]?u[l]:u[l]={}:u[l]=a}).call(t);var n={};(function(){var e;function n(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}var i="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var r,o=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var n=0;n<e.length;++n){var i=e[n];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function a(t,e){if(e)t:{var n=o;t=t.split(".");for(var r=0;r<t.length-1;r++){var a=t[r];if(!(a in n))break t;n=n[a]}(e=e(r=n[t=t[t.length-1]]))!=r&&null!=e&&i(n,t,{configurable:!0,writable:!0,value:e})}}function s(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function l(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:n(t)}}if(a("Symbol",(function(t){function e(t,e){this.g=t,i(this,"description",{configurable:!0,writable:!0,value:e})}if(t)return t;e.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function t(i){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new e(n+(i||"")+"_"+r++,i)}})),a("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var e="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<e.length;r++){var a=o[e[r]];"function"==typeof a&&"function"!=typeof a.prototype[t]&&i(a.prototype,t,{configurable:!0,writable:!0,value:function(){return s(n(this))}})}return t})),"function"==typeof Object.setPrototypeOf)r=Object.setPrototypeOf;else{var c;t:{var u={};try{u.__proto__={a:!0},c=u.a;break t}catch(U){}c=!1}r=c?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var f=r;function h(){this.l=!1,this.h=null,this.j=void 0,this.g=1,this.s=this.m=0,this.i=null}function d(t){if(t.l)throw new TypeError("Generator is already running");t.l=!0}function p(t,e){t.i={M:e,N:!0},t.g=t.m||t.s}function g(t,e,n){return t.g=n,{value:e}}function v(t){this.g=new h,this.h=t}function m(t,e,n,i){try{var r=e.call(t.g.h,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.g.l=!1,r;var o=r.value}catch(a){return t.g.h=null,p(t.g,a),y(t)}return t.g.h=null,i.call(t.g,o),y(t)}function y(t){for(;t.g.g;)try{var e=t.h(t.g);if(e)return t.g.l=!1,{value:e.value,done:!1}}catch(n){t.g.j=void 0,p(t.g,n)}if(t.g.l=!1,t.g.i){if(e=t.g.i,t.g.i=null,e.N)throw e.M;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function b(t){this.next=function(e){return d(t.g),t.g.h?e=m(t,t.g.h.next,e,t.g.o):(t.g.o(e),e=y(t)),e},this.throw=function(e){return d(t.g),t.g.h?e=m(t,t.g.h.throw,e,t.g.o):(p(t.g,e),e=y(t)),e},this.return=function(e){return function(t,e){d(t.g);var n=t.g.h;return n?m(t,"return"in n?n.return:function(t){return{value:t,done:!0}},e,t.g.return):(t.g.return(e),y(t))}(t,e)},this[Symbol.iterator]=function(){return this}}function w(t,e){return e=new b(new v(e)),f&&t.prototype&&f(e,t.prototype),e}h.prototype.o=function(t){this.j=t},h.prototype.return=function(t){this.i={return:t},this.g=this.s};var x="function"==typeof Object.assign?Object.assign:function(t,e){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};a("Object.assign",(function(t){return t||x})),a("Promise",(function(t){function e(t){this.h=0,this.i=void 0,this.g=[],this.o=!1;var e=this.j();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.g=null}function i(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.h=function(t){if(null==this.g){this.g=[];var e=this;this.i((function(){e.l()}))}this.g.push(t)};var r=o.setTimeout;n.prototype.i=function(t){r(t,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var t=this.g;this.g=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(i){this.j(i)}}}this.g=null},n.prototype.j=function(t){this.i((function(){throw t}))},e.prototype.j=function(){function t(t){return function(i){n||(n=!0,t.call(e,i))}}var e=this,n=!1;return{resolve:t(this.D),reject:t(this.l)}},e.prototype.D=function(t){if(t===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.J(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.C(t):this.m(t)}},e.prototype.C=function(t){var e=void 0;try{e=t.then}catch(n){return void this.l(n)}"function"==typeof e?this.K(e,t):this.m(t)},e.prototype.l=function(t){this.s(2,t)},e.prototype.m=function(t){this.s(1,t)},e.prototype.s=function(t,e){if(0!=this.h)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.h);this.h=t,this.i=e,2===this.h&&this.I(),this.A()},e.prototype.I=function(){var t=this;r((function(){if(t.B()){var e=o.console;void 0!==e&&e.error(t.i)}}),1)},e.prototype.B=function(){if(this.o)return!1;var t=o.CustomEvent,e=o.Event,n=o.dispatchEvent;return void 0===n||("function"==typeof t?t=new t("unhandledrejection",{cancelable:!0}):"function"==typeof e?t=new e("unhandledrejection",{cancelable:!0}):(t=o.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,t),t.promise=this,t.reason=this.i,n(t))},e.prototype.A=function(){if(null!=this.g){for(var t=0;t<this.g.length;++t)a.h(this.g[t]);this.g=null}};var a=new n;return e.prototype.J=function(t){var e=this.j();t.F(e.resolve,e.reject)},e.prototype.K=function(t,e){var n=this.j();try{t.call(e,n.resolve,n.reject)}catch(i){n.reject(i)}},e.prototype.then=function(t,n){function i(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(n){o(n)}}:e}var r,o,a=new e((function(t,e){r=t,o=e}));return this.F(i(t,r),i(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.F=function(t,e){function n(){switch(i.h){case 1:t(i.i);break;case 2:e(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},e.resolve=i,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=l(t),o=r.next();!o.done;o=r.next())i(o.value).F(e,n)}))},e.all=function(t){var n=l(t),r=n.next();return r.done?i([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,i(r.value).F(o(a.length-1),e),r=n.next()}while(!r.done)}))},e})),a("Array.prototype.keys",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,i=!1,r={next:function(){if(!i&&n<t.length){var r=n++;return{value:e(r,t[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,(function(t){return t}))}}));var A=this||self;function j(t,e){t=t.split(".");var n,i=A;t[0]in i||void 0===i.execScript||i.execScript("var "+t[0]);for(;t.length&&(n=t.shift());)t.length||void 0===e?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=e}function T(t,e){var n=void 0;return new(n||(n=Promise))((function(i,r){function o(t){try{s(e.next(t))}catch(n){r(n)}}function a(t){try{s(e.throw(t))}catch(n){r(n)}}function s(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,a)}s((e=e.apply(t,void 0)).next())}))}function _(t,e,n){if(n=t.createShader(0===n?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+t.getShaderInfoLog(n));return n}function S(t,e){this.g=t,this.i=e,this.j=0}function E(t,e){var n=t.i;if(void 0===t.l){var i=_(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),r=_(n,"\n  precision highp float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,i),n.attachShader(o,r),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));i=t.l=o,n.useProgram(i),r=n.getUniformLocation(i,"sampler0"),t.h={v:n.getAttribLocation(i,"aVertex"),u:n.getAttribLocation(i,"aTex"),O:r},t.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.o),n.enableVertexAttribArray(t.h.v),n.vertexAttribPointer(t.h.v,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),t.m=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.m),n.enableVertexAttribArray(t.h.u),n.vertexAttribPointer(t.h.u,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(r,0)}i=t.h,n.useProgram(t.l),n.canvas.width=e.width,n.canvas.height=e.height,n.viewport(0,0,e.width,e.height),n.activeTexture(n.TEXTURE0),t.g.bindTexture2d(e.glName),n.enableVertexAttribArray(i.v),n.bindBuffer(n.ARRAY_BUFFER,t.o),n.vertexAttribPointer(i.v,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(i.u),n.bindBuffer(n.ARRAY_BUFFER,t.m),n.vertexAttribPointer(i.u,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(i.v),n.disableVertexAttribArray(i.u),n.bindBuffer(n.ARRAY_BUFFER,null),t.g.bindTexture2d(0)}function O(t){this.g=t}var R=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function C(t,e){return e+t}function k(t,e){window[t]=e}function F(t){for(var e=[],n=t.size(),i=0;i<n;++i){var r=t.get(i);e.push({x:r.x,y:r.y,z:r.z,visibility:r.hasVisibility?r.visibility:void 0})}return e}function L(t){for(var e=[],n=t.size(),i=0;i<n;++i){var r=t.get(i);e.push({index:r.index,score:r.score,label:r.hasLabel?r.label:void 0,displayName:r.hasDisplayName?r.displayName:void 0})}return e}function P(t,e,n){this.graph=t,this.locateFile=e,this.g=n}function D(t){if(this.h=t,this.listeners={},this.j={},this.l={},this.s=this.D=!0,this.B=Promise.resolve(),this.locateFile=t&&t.locateFile||C,"object"==typeof window)t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"==typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}this.C=t}function B(t){return T(t,(function t(){var e,n,i,r,o,a,s,c,u,f=this;return w(t,(function(t){switch(t.g){case 1:return e=f,f.D?(k("createMediapipeSolutionsWasm",{locateFile:f.locateFile}),k("createMediapipeSolutionsPackedAssets",{locateFile:f.locateFile}),n=f.h.files||[],g(t,function(){return T(this,(function t(){return w(t,(function(t){switch(t.g){case 1:return t.m=2,g(t,WebAssembly.instantiate(R),4);case 4:t.g=3,t.m=0;break;case 2:return t.m=0,t.i=null,t.return(!1);case 3:return t.return(!0)}}))}))}(),2)):t.return();case 2:return i=t.j,g(t,Promise.all(n.map((function(t){return void 0===t.simd||t.simd&&i||!t.simd&&!i?function(t){var e=document.createElement("script");return e.setAttribute("src",t),e.setAttribute("crossorigin","anonymous"),document.body.appendChild(e),new Promise((function(t){e.addEventListener("load",(function(){t()}),!1)}))}(e.locateFile(t.url,e.C)):Promise.resolve()}))),3);case 3:return r=window.createMediapipeSolutionsWasm,o=window.createMediapipeSolutionsPackedAssets,g(t,r(o),4);case 4:return f.g=t.j,f.m=document.createElement("canvas"),f.g.canvas=f.m,f.g.createContext(f.m,!0,!0,{}),f.i=new f.g.SolutionWasm,a=new P(f.h.graph,f.locateFile,f.C),g(t,f.loadGraph(a),5);case 5:if(f.h.listeners)for(s=l(f.h.listeners),c=s.next();!c.done;c=s.next())u=c.value,N(f,u);f.D=!1,t.g=0}}))}))}function M(t,e,n){if(n.isNumber())return n.getNumber();if(n.isRect())return n.getRect();if(n.isLandmarks())return n.getLandmarks();if(n.isLandmarksList())return n.getLandmarksList();if(n.isClassificationsList())return n.getClassificationsList();if(n.isObjectDetectionList())return n.getObjectDetectionList();if(n.isTexture2d()){var i=t.l[e];return i||(i=new S(t.g,t.o),t.l[e]=i),E(t=i,n=n.getTexture2d()),t.i.canvas}}function N(t,e){for(var n=e.name||"$",i=[].concat(function(t){if(!(t instanceof Array)){t=l(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}(e.wants)),r=new t.g.StringList,o=l(e.wants),a=o.next();!a.done;a=o.next())r.push_back(a.value);o=t.g.PacketListener.implement({onResults:function(r){return T(t,(function t(){var o,a,s,c,u,f=this;return w(t,(function(t){if(1==t.g){for(o={},a=0;a<e.wants.length;++a)o[i[a]]=r.get(a);var h;if(h=e.outs){for(var d={},p=l(Object.keys(h)),v=p.next();!v.done;v=p.next()){var m=h[v=v.value];if("string"==typeof m)d[v]=M(f,v,o[m]);else{var y=o[m.stream];if(void 0!==y){if("detection_list"===m.type){var b=y.getRectList(),w=y.getLandmarksList();y=y.getClassificationsList();var x=[];if(b)for(var A=0;A<b.size();++A){var j={L:b.get(A),H:F(w.get(A)),G:L(y.get(A))};x.push(j)}d[v]=x}else if("landmarks"===m.type)b=y.getLandmarks(),d[v]=b?F(b):void 0;else if("landmarks_list"===m.type){if(b=y.getLandmarksList()){for(w=[],y=b.size(),x=0;x<y;++x)A=b.get(x),w.push(F(A));b=w}else b=void 0;d[v]=b}else if("rect_list"===m.type){if(b=y.getRectList()){for(w=[],y=b.size(),x=0;x<y;++x)A=b.get(x),w.push(A);b=w}else b=void 0;d[v]=b}else if("classifications_list"===m.type){if(b=y.getClassificationsList()){for(w=[],y=b.size(),x=0;x<y;++x)A=b.get(x),w.push(L(A));b=w}else b=void 0;d[v]=b}else if("object_detection_list"===m.type){if(b=y.getObjectDetectionList()){for(w=[],y=b.size(),x=0;x<y;++x){var T=b.get(x);j=(A=w).push;for(var _=T.id,O=T.keypoints,R=[],C=O.size(),k=0;k<C;++k){var P=O.get(k);R.push({id:P.id,point3d:{x:P.point3d.x,y:P.point3d.y,z:P.point3d.z},point2d:{x:P.point2d.x,y:P.point2d.y,depth:P.point2d.depth}})}j.call(A,{id:_,keypoints:R,visibility:T.visibility})}b=w}else b=void 0;d[v]=b}else{if("texture"!==m.type)throw Error("Unknown output config type: '"+m.type+"'");(b=f.l[v])||(b=new S(f.g,f.o),f.l[v]=b),E(b,w=y.getTexture2d()),d[v]=b.i.canvas}m.transform&&d[v]&&(d[v]=m.transform(d[v]))}}}h=d}else h=o;return s=h,(c=f.listeners[n])?t=g(t,f.B,3):(t.g=0,t=void 0),t}if(u=c(s))return f.B=u,t.return(u);t.g=0}))}))}}),t.i.attachMultiListener(r,o),r.delete()}function I(t){t=t||{},this.g=new D({locateFile:t.locateFile,files:[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"}],graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"landmarks_list",stream:"multi_hand_landmarks"},multiHandedness:{type:"classifications_list",stream:"multi_handedness",transform:function(t){return t.map((function(t){return t[0]}))}}}}],options:{selfieMode:{type:1,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},minDetectionConfidence:{type:0,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:0,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}P.prototype.toArrayBuffer=function(){return T(this,(function t(){var e,n=this;return w(t,(function(t){return 1==t.g?(n.graph.url?t=g(t,fetch(n.locateFile(n.graph.url,n.g)),3):(t.g=2,t=void 0),t):2!=t.g&&(e=t.j).body?t.return(e.arrayBuffer()):t.return(new ArrayBuffer(0))}))}))},(e=D.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},e.reset=function(){return T(this,(function t(){var e=this;return w(t,(function(t){e.i&&(e.i.reset(),e.j={},e.l={}),t.g=0}))}))},e.setOptions=function(t){if(this.h.options){for(var e=[],n=l(Object.keys(t)),i=n.next();!i.done;i=n.next()){var r=i.value;(i=this.h.options[r])&&i.graphOptionXref&&(r={valueNumber:0===i.type?t[r]:0,valueBoolean:1===i.type&&t[r]},i=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),i.graphOptionXref),r),e.push(i))}0!==e.length&&(this.s=!0,this.A=e)}},e.initialize=function(){return T(this,(function t(){var e=this;return w(t,(function(t){return 1==t.g?g(t,B(e),2):g(t,T(e,(function t(){var e,n,i,r,o,a=this;return w(t,(function(t){if(!a.s)return t.return();if(!(e=a.m.getContext("webgl2"))&&!(e=a.m.getContext("webgl")))return alert("Failed to create WebGL canvas context when passing video frame."),t.return();if(a.o=e,a.A){for(n=new a.g.GraphOptionChangeRequestList,i=l(a.A),r=i.next();!r.done;r=i.next())o=r.value,n.push_back(o);a.i.changeOptions(n),n.delete(),a.A=void 0}a.s=!1,t.g=0}))})),0)}))}))},e.loadGraph=function(t){return T(this,(function e(){var n,i=this;return w(e,(function(e){if(1==e.g)return g(e,t.toArrayBuffer(),2);n=e.j,i.i.loadGraph(n),e.g=0}))}))},e.send=function(t,e){return T(this,(function n(){var i,r,o,a,s,c,u,f,h,d=this;return w(n,(function(n){if(1==n.g)return d.h.inputs?(i=1e3*(e||performance.now()),g(n,d.B,2)):n.return();if(3!=n.g)return g(n,d.initialize(),3);for(r=new d.g.PacketDataList,o=l(Object.keys(t)),a=o.next();!a.done;a=o.next())if(s=a.value,c=d.h.inputs[s]){t:{var p=d,v=t[s];switch(c.type){case"video":var m=p.j[c.stream];if(m||(m=new S(p.g,p.o),p.j[c.stream]=m),0===(p=m).j&&(p.j=p.g.createTexture()),v instanceof HTMLVideoElement){var y=v.videoWidth;m=v.videoHeight}else v instanceof HTMLImageElement?(y=v.naturalWidth,m=v.naturalHeight):(y=v.width,m=v.height);m={glName:p.j,width:y,height:m},(y=p.i).canvas.width=m.width,y.canvas.height=m.height,y.activeTexture(y.TEXTURE0),p.g.bindTexture2d(p.j),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,v),p.g.bindTexture2d(0),p=m;break t;case"detections":for((m=p.j[c.stream])||(m=new O(p.g),p.j[c.stream]=m),(p=m).data||(p.data=new p.g.DetectionListData),p.data.reset(v.length),m=0;m<v.length;++m){y=v[m],p.data.setBoundingBox(m,y.L);for(var b=0;b<y.H.length;++b){var w=y.H[b],x=!!w.visibility;p.data.addNormalizedLandmark(m,Object.assign(Object.assign({},w),{hasVisibility:x,visibility:x?w.visibility:0}))}for(b=0;b<y.G.length;++b){x=!!(w=y.G[b]).index;var A=!!w.label,j=!!w.displayName;p.data.addClassification(m,{score:w.score,hasIndex:x,index:x?w.index:-1,hasLabel:A,label:A?w.label:"",hasDisplayName:j,displayName:j?w.displayName:""})}}p=p.data;break t;default:p={}}}switch(u=p,f=c.stream,c.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},u),{stream:f,timestamp:i}));break;case"detections":(h=u).stream=f,h.timestamp=i,r.pushDetectionList(h);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}d.i.send(r),r.delete(),n.g=0}))}))},e.onResults=function(t,e){this.listeners[e||"$"]=t},j("Solution",D),j("OptionType",{NUMBER:0,BOOL:1,0:"NUMBER",1:"BOOL"}),(e=I.prototype).close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(t){this.g.onResults(t)},e.initialize=function(){return T(this,(function t(){var e=this;return w(t,(function(t){return g(t,e.g.initialize(),0)}))}))},e.reset=function(){this.g.reset()},e.send=function(t){return T(this,(function e(){var n=this;return w(e,(function(e){return g(e,n.g.send(t),0)}))}))},e.setOptions=function(t){this.g.setOptions(t)},j("Hands",I),j("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]])}).call(t);var i=Object.defineProperty,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,e,n)=>e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,l=(t,e)=>{for(var n in e||(e={}))o.call(e,n)&&s(t,n,e[n]);if(r)for(var n of r(e))a.call(e,n)&&s(t,n,e[n]);return t};class c{constructor(t,e){this.x=t,this.y=e}clone(){return new c(this.x,this.y)}add(t){return new c(this.x+t.x,this.y+t.y)}multiply(t){return new c(this.x*t,this.y*t)}dot(t){return this.x*t.x+this.y*t.y}dist(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}}const u=c;function f(){return{width:window.innerWidth,height:window.innerHeight}}function h(t){return{width:t.clientWidth||t.width,height:t.clientHeight||t.height}}function d(t,e,n,i){const r=i||window.devicePixelRatio||1;let o=e||h(t).width,a=n||h(t).height;t.width=o*r,t.height=a*r,t.style.width=o+"px",t.style.height=a+"px",1!=r&&t.getContext("2d").setTransform(r,0,0,r,0,0)}var p,g,v;new c(0,0),new c(1,1),(g=p||(p={}))[g.KeyboardPressed=0]="KeyboardPressed",g[g.KeyboardDown=1]="KeyboardDown",g[g.Mouse=2]="Mouse",g[g.Window=3]="Window",g[g.Custom=4]="Custom",g[g.All=5]="All",(v=function(){function t(t){return i.appendChild(t.dom),t}function e(t){for(var e=0;e<i.children.length;e++)i.children[e].style.display=e===t?"block":"none";n=t}var n=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),e(++n%i.children.length)}),!1);var r=(performance||Date).now(),o=r,a=0,s=t(new v.Panel("FPS","#0ff","#002")),l=t(new v.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new v.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:i,addPanel:t,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(l.update(t-r,200),t>o+1e3&&(s.update(1e3*a/(t-o),100),o=t,a=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:i,setMode:e}}).Panel=function(t,e,n){var i=1/0,r=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,l=48*a,c=3*a,u=2*a,f=3*a,h=15*a,d=74*a,p=30*a,g=document.createElement("canvas");g.width=s,g.height=l,g.style.cssText="width:80px;height:48px";var v=g.getContext("2d");return v.font="bold "+9*a+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,s,l),v.fillStyle=e,v.fillText(t,c,u),v.fillRect(f,h,d,p),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(f,h,d,p),{dom:g,update:function(l,m){i=Math.min(i,l),r=Math.max(r,l),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,s,h),v.fillStyle=e,v.fillText(o(l)+" "+t+" ("+o(i)+"-"+o(r)+")",c,u),v.drawImage(g,f+a,h,d-a,p,f,h,d-a,p),v.fillRect(f+d-a,h,a,p),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(f+d-a,h,a,o((1-l/m)*p))}}},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};class m extends Error{constructor(t,e){super(e?`[${e.capitalize()}] - ${t}`:t),this.name="EngineFailure"}}class y extends m{constructor(t){super(t,"renderer")}}const b={strokeStyle:"black",lineWidth:2,lineJoin:"round",lineCap:"round",fillStyle:"transparent",globalAlpha:1,globalCompositeOperation:"add"},w={font:"Roboto",size:16,color:"black"},x=2*Math.PI;let A,j,T=null==self.document&&null==self.window?4:2*(window.devicePixelRatio||1);function _(t){return~~(t*T)/T}class S{static create(t,e){let[n,i]=[f().width,f().height];const r=function(t,e,n,i){const r=document.createElement("canvas");return d(r,t,e,n),i&&(r.oncontextmenu=t=>t.preventDefault()),r}(t||n,e||i);return function(t,e){window.addEventListener("DOMContentLoaded",(()=>{var n;const i=null!=(n=document.querySelector(e))?n:document.createElement(e);i.appendChild(t),document.querySelector("body").appendChild(i)}))}(r,"main"),S.setContext(r.getContext("2d")),r}static createFromCanvas(t){let e=document.querySelector(t);if(!(e&&e instanceof HTMLCanvasElement))throw new y("The selected element is not a canvas");return d(e),S.setContext(e.getContext("2d")),e}static setContext(t){A=t}static getContext(){return A}static style(t){if(!A)throw new y("Context has not been initialize. Please use Renderer.setContext");const e=l(l({},b),t);if(e!==j){for(let t in e)A[t]!==e[t]&&(A[t]=e[t]);j=e}}static clear(t){t?(S.style({fillStyle:t}),A.fillRect(0,0,A.canvas.width,A.canvas.height)):A.clearRect(0,0,A.canvas.width,A.canvas.height)}static line(t,e,n,i,r){S.style(r),A.beginPath(),A.moveTo(_(t),_(e)),A.lineTo(_(n),_(i)),A.stroke()}static rect(t,e,n,i,r){S.style(r);const[o,a,s,l]=[_(t),_(e),_(n),_(i)];A.fillRect(o,a,s,l),A.strokeRect(o,a,s,l)}static rectFromCenter(t,e,n,i,r){return S.rect(t-n/2,e-i/2,n,i,r)}static rectFromPoints(t,e,n,i,r){return S.rect(t,e,n-t,i-e,r)}static poly(t,e){if(t.length){S.style(e),A.beginPath(),A.moveTo(_(t[0].x),_(t[0].y));for(let e=1;e<t.length;e++)A.lineTo(_(t[e].x),_(t[e].y));A.stroke()}}static circle(t,e,n,i){S.style(i),A.beginPath(),A.arc(_(t),_(e),n,0,x),A.fill(),A.stroke()}static circleFromRect(t,e,n,i,r){return S.circle(t+n/2,e+i/2,Math.min(n,i)/2,r)}static point(t,e,n){S.circle(t,e,5,n)}static rectSprite(t,e,n,i,r){S.style({}),A.save(),A.translate(_(t+n/2),_(e+i/2)),A.scale(r.scale.x,r.scale.y),A.rotate(r.rotation),A.drawImage(r.image,_(n*r.offset.x-n/2),_(i*r.offset.y-i/2),_(n),_(i)),A.restore()}static circleSprite(t,e,n,i){A.save(),A.beginPath(),A.arc(_(t),_(e),n,0,x),A.clip(),S.rectSprite(t-n,e-n,2*n,2*n,i),A.restore()}static text(t,e,n,i){if(A){let t=l(l({},w),i);A.font=`${t.size}px ${t.font}`,S.style({fillStyle:t.color})}A.fillText(t,e,n)}static tint(t,e,n,i,r){S.rect(e,n,i,r,{fillStyle:t,globalCompositeOperation:"multiply",globalAlpha:.25})}static beginFrame(t){S.clear(t)}static endFrame(){}}let E=[],O=4;const R=["top-left","top-right","bottom-left","bottom-right","custom"];class C{static addItem(t,e,n){C.internalAddItem(t,e,n)}static addButton(t,e,n,i){C.internalAddItem(t,n,i,e)}static internalAddItem(t,e,n,i){const r={callback:t,position:e,options:n,onClick:i};E.push(r);const o=E.length;window.addEventListener("load",(()=>C.addToDom(r,o)))}static init(){C.addStyle('*,\n*::after,\n*::before {\n    box-sizing: border-box;\n}\n\nbody {\n    margin: 0;\n    font-family: "Roboto";\n    font-weight: 400;\n    width: 100vw;\n    height: 100vh;\n    overflow: hidden;\n}\n\ncanvas {\n    z-index: 10;\n}\n\n.ue-interface {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    padding: 0.5em;\n    z-index: 10;\n    /* Make the click event pass through */\n    pointer-events: none;\n}\n\n.ue-container>div {\n    position: absolute;\n    display: flex;\n    flex-flow: column nowrap;\n}\n\n.ue-container>.top-left {\n    top: 0;\n    left: 0;\n}\n\n.ue-container>.top-right {\n    top: 0;\n    right: 0;\n    text-align: right;\n}\n\n.ue-container>.bottom-left {\n    bottom: 0;\n    left: 0;\n}\n\n.ue-container>.bottom-right {\n    bottom: 0;\n    right: 0;\n    text-align: right;\n}\n\n.ue-interface-items {\n    padding: .1em;\n}\n\n.ue-interface-button {\n    cursor: pointer;\n    user-select: none;\n}');const t=document.createElement("div");t.classList.add("ue-interface","ue-container");for(let e of R){const n=document.createElement("div");n.classList.add(e),t.appendChild(n)}document.body.appendChild(t)}static addStyle(t){const e=document.createElement("style");e.textContent=t,document.head.append(e)}static addToDom(t,e){var n,i;const r=t.callback(),o=document.createElement("span");o.classList.add("ue-interface-items"),o.id=`item-${e}`,o.innerText=r,Object.entries(t.options||{}).forEach((([t,e])=>o.style[t]=e)),t.position?null==(n=document.querySelector(`.ue-container > .${t.position}`))||n.appendChild(o):null==(i=document.querySelector(".ue-container > .custom"))||i.appendChild(o),t.onClick&&(o.addEventListener("click",(e=>t.onClick(e))),o.classList.add("ue-interface-button"))}static update(){E.forEach(((t,e)=>{const n=t.callback(),i=document.querySelector(`.ue-interface #item-${e+1}`);i&&i.innerText!==n&&(i.innerText=n)}))}static statsShift(t){const e=document.querySelector(".top-left");e&&(e.style.top=`${t}px`)}static setUpdateInterval(t){O=t}static get updateInterval(){return O}}export{S as B,u as a,e as c,n as h,C as l,f as y};
